\CUSDependency{package={amsmath}}
\CUSProvideExplLibrary{math}{\cus@d@te}{\cus@versi@n}{typeset math}

%% hacking everymath and everydisplay
\cus_toks_new:N \cus@everyinlinemath
\cus_toks_new:N \cus@everydisplaymath
\cus_toks_gput_right:Nn \frozen@everymath { \the\cus@everyinlinemath }
\cus_toks_gput_right:Nn \frozen@everydisplay { \the\cus@everydisplaymath }
%%

\cs_new_protected_nopar:Npn \cus_left: { \mathopen{}\mathclose\bgroup\left }
\cs_new_protected_nopar:Npn \cus_right: { \aftergroup\egroup\right }
\cs_new_protected_nopar:Npn \delsizel
  { \__cus_delsize:NNnn \cus_left: \tex_mathopen:D }
\cs_new_protected_nopar:Npn \delsizer
  { \__cus_delsize:NNnn \cus_right: \tex_mathclose:D }
\cs_new_nopar:Npn \__cus_delsize:NNnn #1#2#3#4
  {
    \fp_compare:nNnTF {#3} < { 0 }
      { #1 #4 }
      { #2 { \exp_args:Nf \bBigg@ { \fp_eval:n { (#3)/1.2 } } {#4} } }
  }
\cs_new_protected_nopar:Npn \bigsizel #1#2
  { \tex_mathopen:D { \exp_args:Nf \bBigg@ { \fp_eval:n {#1} } {#2} } }
\cs_new_protected_nopar:Npn \bigsizer #1#2
  { \tex_mathclose:D { \exp_args:Nf \bBigg@ { \fp_eval:n {#1} } {#2} } }